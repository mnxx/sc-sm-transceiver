# Copyright 2017 Communications Engineering Lab - KIT.
# All Rights Reserved.
# Author: Manuel Roth.
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the GNU General Public License v3.0 is distributed on an "AS IS"
# BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""
Create BER/SNR plots using a list of calculated points.

"""


import numpy as np
import matplotlib.pyplot as plt

# Flat-fading:
#flat2x2_1024_2 = [0.446484375, 0.3939453125, 0.385888671875, 0.33056640625, 0.2677734375, 0.32841796875, 0.0755859375, 0.04951171875, 0.039892578125, 0.0404296875, 0.0474609375]

flat2x2_1024_4 = [0.490515625, 0.480546875, 0.44828125, 0.4129296875, 0.350921875, 0.299640625, 0.2318671875, 0.167890625, 0.09975, 0.077734375, 0.0531171875, 0.022859375, 0.0361015625, 0.018515625, 0.01715625, 0.007921875, 0.003734375, 0.0061875, 0.005375, 0.0001875, 8.59375e-05]

flat2x2_128_4 = [0.5070703125, 0.4975, 0.498671875, 0.5027734375, 0.4933203125, 0.508359375, 0.475234375, 0.429140625, 0.3738671875, 0.263359375, 0.1815234375, 0.131796875, 0.0955625, 0.067421875, 0.0453671875, 0.03234375, 0.0200390625, 0.0133359375, 0.0084140625, 0.0052265625, 0.003015625]#[0.4953515625, 0.50078125, 0.4972265625, 0.5115234375, 0.4904296875, 0.5104296875, 0.4964453125, 0.44328125, 0.3788671875, 0.2826171875, 0.1771875, 0.108515625, 0.1179296875, 0.065859375, 0.052421875, 0.03796875] #[0.3084453125, 0.25018359375, 0.1877265625, 0.12924609375, 0.08386328125, 0.05413671875, 0.0325859375, 0.01940234375, 0.00893359375, 0.0049140625, 0.0034375, 0.0014453125, 0.0006484375, 0.00068359375, 0.0008828125, 0.00071484375] # 

flat2x2_128_4perf = [0.3159375, 0.21125, 0.1785546875, 0.10984375, 0.07453125, 0.05, 0.0178515625, 0.00359375, 0.0067578125, 0.0065234375, 0.0002734375, 0.00203125, 0.0, 0.0046875, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

#[0.4364404296875, 0.420615234375, 0.391162109375, 0.355322265625, 0.3308740234375, 0.3052392578125, 0.2096923828125, 0.093466796875, 0.0644384765625, 0.0505615234375, 0.032080078125, 0.00904296875, 0.0064013671875, 0.020595703125, 0.000947265625, 0.032783203125, 0.0002197265625, 0.0011962890625, 0.0, 0.00494140625, 0.0] #[0.425341796875, 0.43642578125, 0.4, 0.342138671875, 0.339208984375, 0.235791015625, 0.198046875, 0.17451171875, 0.098828125, 0.05908203125, 0.04111328125, 0.015380859375, 0.0171875, 0.0056640625, 0.003759765625, 0.05]

unifrom2x2_1024_4 = [0.497109375, 0.4818515625, 0.470609375, 0.42990625, 0.3957109375, 0.3831953125, 0.3209140625, 0.2970859375, 0.251578125, 0.245125, 0.23525, 0.2382578125, 0.2022734375, 0.20303125, 0.206875, 0.2019453125, 0.1709765625, 0.1925078125, 0.1959140625, 0.2235859375, 0.2107734375]

unifrom2x2_128_4 = [0.491171875, 0.4980859375, 0.500625, 0.506875, 0.48578125, 0.4421484375, 0.3733984375, 0.2196875, 0.10890625, 0.0308984375, 0.0159765625, 0.00890625, 0.0048828125, 0.003675, 0.00303125, 0.00273125, 0.00260625, 0.0024203125, 0.0024078125, 0.0024609375, 0.0024953125]
#[0.4940234375, 0.5031640625, 0.5073046875, 0.503828125, 0.4903515625, 0.46296875, 0.3792578125, 0.243984375, 0.104453125, 0.05453125, 0.0258984375, 0.0040234375, 0.01390625, 0.0074609375, 0.0094140625, 0.01125]

unifrom2x2_128_4perf = [0.1601953125, 0.08234375, 0.033515625, 0.010234375, 0.005, 0.0003515625, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
#[0.4994921875, 0.48796875, 0.5037109375, 0.51515625, 0.4874609375, 0.478046875, 0.395859375, 0.260703125, 0.1269921875, 0.06640625, 0.021015625, 0.008046875, 0.00828125, 0.00390625, 0.0004296875, 0.0058203125, 0.0108203125, 0.0052734375, 0.0019921875, 0.003671875, 0.0015234375]


#[0.4420166015625, 0.4194140625, 0.3810107421875, 0.351337890625, 0.25693359375, 0.1837646484375, 0.16828125, 0.1809912109375, 0.10703125, 0.042353515625, 0.0272802734375, 0.0025244140625, 0.0020458984375, 0.0337451171875, 0.024296875, 0.053828125, 0.0206787109375, 0.0482470703125, 0.034375, 0.046171875, 0.020859375] #[0.447119140625, 0.41669921875, 0.3720703125, 0.335693359375, 0.229150390625, 0.21328125, 0.1865234375, 0.1017578125, 0.11865234375, 0.037158203125, 0.007421875, 0.021044921875, 0.059521484375, 0.07470703125, 0.04296875, 0.06474609375]

linea1r2x2_1024_4 = [0.4918203125, 0.4842265625, 0.4633046875, 0.42453125, 0.3955390625, 0.3448828125, 0.2990234375, 0.234, 0.198328125, 0.208359375, 0.19259375, 0.1688671875, 0.1256484375, 0.14490625, 0.139546875, 0.146859375, 0.121359375, 0.1755625, 0.13065625, 0.141515625, 0.1420703125]

linea1r2x2_128_4 = [0.5146875, 0.50515625, 0.5043359375, 0.491875, 0.512109375, 0.4654296875, 0.43359375, 0.3168359375, 0.1867578125, 0.078671875, 0.02515625, 0.010546875, 0.005625, 0.0038515625, 0.0030703125, 0.00288125, 0.0027765625, 0.0027375, 0.0024921875, 0.002421875, 0.002478125]#[0.495390625, 0.5005078125, 0.4998046875, 0.5041796875, 0.48484375, 0.500234375, 0.430859375, 0.2844921875, 0.1955859375, 0.0762890625, 0.029765625, 0.0120703125, 0.0097265625, 0.005, 0.0021484375, 0.002265625]

linea1r2x2_128_4perf = [0.192109375, 0.10828125, 0.064296875, 0.022734375, 0.0056640625, 0.00125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
#[0.4983203125, 0.50375, 0.5041015625, 0.494453125, 0.5002734375, 0.4842578125, 0.4254296875, 0.303125, 0.1795703125, 0.0827734375, 0.0379296875, 0.008359375, 0.0058203125, 0.007734375, 0.003359375, 0.007421875, 0.002734375, 0.0031640625, 0.0037109375, 0.005234375, 0.0026953125]


#[0.4458984375, 0.3707861328125, 0.3760986328125, 0.3507177734375, 0.2819921875, 0.1987451171875, 0.132392578125, 0.148046875, 0.047900390625, 0.0508544921875, 0.0308154296875, 0.00181640625, 0.0114306640625, 0.0279638671875, 0.0577734375, 0.02244140625, 0.02150390625, 0.006669921875, 0.020556640625, 0.0333837890625, 0.0170263671875] #[0.443408203125, 0.37197265625, 0.373486328125, 0.3427734375, 0.28408203125, 0.209521484375, 0.152001953125, 0.111376953125, 0.0791015625, 0.03408203125, 0.070751953125, 0.00849609375, 0.043017578125, 0.021044921875, 0.02880859375, 0.02412109375]

linea2r2x2_1024_4 = [0.4906796875, 0.4820703125, 0.458625, 0.440984375, 0.400296875, 0.37496875, 0.3511875, 0.306046875, 0.2897734375, 0.282390625, 0.28921875, 0.2852734375, 0.25828125, 0.255703125, 0.2377890625, 0.2394921875, 0.2476875, 0.25359375, 0.2494609375, 0.2451015625, 0.2491796875]

linea2r2x2_128_4 = [0.5066015625, 0.500625, 0.4967578125, 0.5066015625, 0.4973828125, 0.4709765625, 0.38390625, 0.24921875, 0.08875, 0.0348046875, 0.0118359375, 0.00615234375, 0.0033984375, 0.002984375, 0.0027328125, 0.00244375, 0.0024796875, 0.0024640625, 0.0024625, 0.0024890625, 0.00245625]
#[0.49609375, 0.513203125, 0.497890625, 0.50453125, 0.4899609375, 0.4596875, 0.35015625, 0.231015625, 0.088203125, 0.0355859375, 0.0123828125, 0.0051953125, 0.003359375, 0.0008984375, 0.00984375, 0.001640625]

linea2r2x2_128_4perf = [0.1658203125, 0.092734375, 0.0493359375, 0.009453125, 0.002265625, 0.000234375, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
#[0.49453125, 0.5057421875, 0.505703125, 0.49625, 0.511015625, 0.47171875, 0.3805078125, 0.2366015625, 0.10984375, 0.036484375, 0.016015625, 0.0082421875, 0.00421875, 0.0051171875, 0.001875, 0.00109375, 0.0029296875, 0.003046875, 0.001796875, 0.00171875, 0.007578125]


#[0.43037109375, 0.40283203125, 0.398193359375, 0.312255859375, 0.300048828125, 0.1994140625, 0.18271484375, 0.149951171875, 0.118212890625, 0.087744140625, 0.053125, 0.020703125, 0.03603515625, 0.0017578125, 0.045458984375, 0.037841796875]

epa2x2_1024_4 = [0.4833203125, 0.489404296875, 0.4622705078125, 0.4171630859375, 0.4118017578125, 0.3623681640625, 0.346494140625, 0.2839111328125, 0.2419189453125, 0.1816162109375, 0.157978515625, 0.1392822265625, 0.16501953125, 0.149716796875, 0.211376953125, 0.119833984375, 0.1521875, 0.0921142578125, 0.1552734375, 0.1702734375, 0.116689453125] #[0.446240234375, 0.416748046875, 0.40009765625, 0.35048828125, 0.35986328125, 0.265771484375, 0.208740234375, 0.169921875, 0.114892578125, 0.10341796875, 0.046044921875, 0.0296875, 0.0388671875, 0.057080078125, 0.04384765625, 0.016259765625]

epa2x2_128_4 = [0.496484375, 0.506015625, 0.5151171875, 0.5143359375, 0.5091796875, 0.4949609375, 0.4797265625, 0.4779296875, 0.377578125, 0.30765625, 0.2129296875, 0.162265625, 0.128046875, 0.094921875, 0.08775, 0.0855546875, 0.0818984375, 0.078125, 0.07734375, 0.0751484375, 0.0752265625]
#[0.5062890625, 0.503125, 0.501171875, 0.49015625, 0.4958203125, 0.493046875, 0.50125, 0.4715234375, 0.458515625, 0.419765625, 0.39703125, 0.380390625, 0.403515625, 0.370703125, 0.39265625, 0.3615625]

epa2x2_128_4perf = [0.49109375, 0.485, 0.4906640625, 0.4988671875, 0.492578125, 0.5025, 0.5023046875, 0.50203125, 0.4973046875, 0.5048828125, 0.4978515625, 0.5007421875, 0.5023046875, 0.503203125, 0.5000390625, 0.50359375, 0.500078125, 0.4991015625, 0.503046875, 0.50234375, 0.4973046875]
#[0.499375, 0.497109375, 0.5028125, 0.4967578125, 0.4989453125, 0.4993359375, 0.4977734375, 0.49890625, 0.4997265625, 0.50609375, 0.4974609375, 0.504375, 0.496171875, 0.505703125, 0.501328125, 0.503046875, 0.5037109375, 0.5035546875, 0.5030078125, 0.501015625, 0.497421875]


eva2x2_128_4 = [0.5033984375, 0.50078125, 0.5006640625, 0.507578125, 0.5091796875, 0.49265625, 0.505, 0.5051953125, 0.4981640625, 0.471640625, 0.4431640625, 0.4141015625, 0.3883203125, 0.3455078125, 0.3260546875, 0.3382421875, 0.31953125, 0.3373828125, 0.3258203125, 0.3242578125, 0.31953125]#[0.5069140625, 0.5018359375, 0.4998046875, 0.501796875, 0.490078125, 0.5009375, 0.4949609375, 0.487734375, 0.4867578125, 0.4666015625, 0.502265625, 0.51546875, 0.5436328125, 0.5181640625, 0.52515625, 0.5482421875]

eva2x2_128_4perf = [0.4721484375, 0.4553515625, 0.440546875, 0.4041796875, 0.3763671875, 0.3640625, 0.3554296875, 0.3604296875, 0.31671875, 0.3637109375, 0.3144140625, 0.2636328125, 0.31296875, 0.282734375, 0.310234375, 0.322265625, 0.262265625, 0.2903125, 0.274296875, 0.317890625, 0.25875]#[0.4981640625, 0.5045703125, 0.502890625, 0.502578125, 0.49625, 0.49765625, 0.495, 0.501015625, 0.5134375, 0.4752734375, 0.4251953125, 0.354375, 0.316171875, 0.2415234375, 0.20296875, 0.2072265625, 0.2648828125, 0.2203125, 0.2578125, 0.2376171875, 0.249609375]


etu2x2_128_4 = [0.5053515625, 0.502890625, 0.50125, 0.5023046875, 0.4981640625, 0.4912890625, 0.499140625, 0.4910546875, 0.5083984375, 0.4773828125, 0.4571484375, 0.4612890625, 0.4374609375, 0.4511328125, 0.4255078125, 0.417265625, 0.4387109375, 0.42421875, 0.429375, 0.431953125, 0.435859375]
#[0.5026171875, 0.493125, 0.5098828125, 0.50328125, 0.5022265625, 0.500390625, 0.4922265625, 0.5032421875, 0.50375, 0.4971484375, 0.4928515625, 0.485078125, 0.4880859375, 0.4830078125, 0.4803515625, 0.4897265625]

etu2x2_128_4perf = [0.48, 0.479296875, 0.4489453125, 0.4415625, 0.41984375, 0.41, 0.406484375, 0.3561328125, 0.36265625, 0.365, 0.3672265625, 0.44859375, 0.3262890625, 0.354921875, 0.3500390625, 0.3755078125, 0.360859375, 0.381640625, 0.3276953125, 0.32125, 0.3419921875]
#[0.503515625, 0.506015625, 0.4926171875, 0.50796875, 0.508515625, 0.5084375, 0.501875, 0.49734375, 0.4641796875, 0.427890625, 0.3892578125, 0.32875, 0.269765625, 0.2662109375, 0.26515625, 0.2818359375, 0.252421875, 0.2656640625, 0.260859375, 0.2676953125, 0.2698046875]


# BER is measured for the following SNRs.
steps = np.arange(0, 42, 2)

# Plot the results in a BER over SNR plot.
plt.figure(1)

plt.title('MIMO-setup: 2x2; K=128; M=4')
#plt.plot(steps, flat2x2_128_4, 'g-<', label='Flat fading')
#plt.plot(steps, unifrom2x2_128_4, 'r-<', label='Rayleigh, P=3')
#plt.plot(steps, linea1r2x2_128_4, 'b-<', label='Rayleigh, short linear CIR')
#plt.plot(steps, linea2r2x2_128_4, 'm-<', label='Rayleigh, long linear CIR')
#plt.plot(steps, flat2x2_128_4ss, 'g-<', label='Flat fading')
#plt.plot(steps, unifrom2x2_128_4ss, 'r-<', label='Rayleigh, P=3')
#plt.plot(steps, linea1r2x2_128_4ss, 'b-<', label='Rayleigh, short linear CIR')
#plt.plot(steps, linea2r2x2_128_4ss, 'm-<', label='Rayleigh, long linear CIR')
#plt.plot(steps, flat2x2_128_4perf, 'g-<', label='Flat fading')
#plt.plot(steps, unifrom2x2_128_4perf, 'r-<', label='Rayleigh, P=3')
#plt.plot(steps, linea1r2x2_128_4perf, 'b-<', label='Rayleigh, short linear CIR')
#plt.plot(steps, linea2r2x2_128_4perf, 'm-<', label='Rayleigh, long linear CIR')
plt.plot(steps, epa2x2_128_4, 'r-<', label='LTE, EPA')
plt.plot(steps, eva2x2_128_4, 'b-<', label='LTE, EVA')
plt.plot(steps, etu2x2_128_4, 'k-<', label='LTE, ETU')
#plt.plot(steps, epa2x2_128_4ss, 'r-<', label='LTE, EPA')
#plt.plot(steps, eva2x2_128_4ss, 'b-<', label='LTE, EVA')
#plt.plot(steps, etu2x2_128_4ss, 'k-<', label='LTE, ETU')
#plt.plot(steps, epa2x2_128_4perf, 'r-<', label='LTE, EPA')
#plt.plot(steps, eva2x2_128_4perf, 'b-<', label='LTE, EVA')
#plt.plot(steps, etu2x2_128_4perf, 'k-<', label='LTE, ETU')
plt.axis([0, 40, 0.001, 1])
plt.xlabel('SNR / dB')
plt.yscale('log')
plt.grid()
plt.legend()

#plt.show()

from matplotlib2tikz import save as tikz_save
tikz_save('../master-thesis/figures/lte.tex', figureheight='9.5cm', figurewidth='14.5cm');
